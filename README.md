assumptions:
- reference must be inside a formula
- input is valid (no checks for currently)